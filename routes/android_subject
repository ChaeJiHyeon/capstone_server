var mysql = require('mysql');
var pool= require('../database/db_conn');

var db_pool   ={
    connectionLimit : 10, 
    host     : pool.host,
    user     : pool.user,
    password : pool.password,
    database : pool.database
};

var conn = mysql.createConnection(db_pool);
conn.connect();

var ansubject = function(req, res){
    console.log('/process/ansubject 호출됨.');

    var student_number = req.body.id;

    var columns = ['subject_name'];
    var tablename = 'subject';
    
    
    var exec = conn.query("select ?? from ?? where student_number = ?", [columns, tablename, '20174144'], function(err, rows) {
    
        console.log('실행 대상 SQL : ' + exec.sql);
        
        var sqlrow = {rows};
        console.log(sqlrow);
        if (rows.length > 0) {
            res.send(sqlrow);
            console.log("과목 전송 성공");
        } else {
            console.log("일치하는 사용자를 찾지 못함.");
        }
    });
    
}

module.exports.ansubject = ansubject;